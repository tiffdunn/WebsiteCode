<!DOCTYPE html><html lang="en-us" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.8.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Tiffany Dunn">

  
  
  
    
  
  <meta name="description" content="Note to me: edit this later with the revisions you had for the Kiaser app
Here is a revision of a final project I submitted in Fall of 2019 for an Analysis of Categorical Data Analysis course at UC Davis.">

  
  <link rel="alternate" hreflang="en-us" href="/post/2020-05-21-r-rmarkdown/">

  


  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css" integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      
        
      

      
    
      

      
      

      
    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  




  


  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="/post/2020-05-21-r-rmarkdown/">

  
  
  
  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="og:site_name" content="Tiffany Dunn">
  <meta property="og:url" content="/post/2020-05-21-r-rmarkdown/">
  <meta property="og:title" content="Categorical Statistics | Tiffany Dunn">
  <meta property="og:description" content="Note to me: edit this later with the revisions you had for the Kiaser app
Here is a revision of a final project I submitted in Fall of 2019 for an Analysis of Categorical Data Analysis course at UC Davis."><meta property="og:image" content="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_512x512_fill_lanczos_center_2.png">
  <meta property="twitter:image" content="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_512x512_fill_lanczos_center_2.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2020-05-21T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2020-05-21T00:00:00&#43;00:00">
  

  


    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/post/2020-05-21-r-rmarkdown/"
  },
  "headline": "Categorical Statistics",
  
  "datePublished": "2020-05-21T00:00:00Z",
  "dateModified": "2020-05-21T00:00:00Z",
  
  "author": {
    "@type": "Person",
    "name": "Tiffany Dunn"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Tiffany Dunn",
    "logo": {
      "@type": "ImageObject",
      "url": "/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_192x192_fill_lanczos_center_2.png"
    }
  },
  "description": "Note to me: edit this later with the revisions you had for the Kiaser app\nHere is a revision of a final project I submitted in Fall of 2019 for an Analysis of Categorical Data Analysis course at UC Davis."
}
</script>

  

  


  


  





  <title>Categorical Statistics | Tiffany Dunn</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  







<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">Tiffany Dunn</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">Tiffany Dunn</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#hero"><span>Demo</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#featured"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/courses/"><span>Courses</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link js-theme-selector" data-toggle="dropdown" aria-haspopup="true">
          <i class="fas fa-palette" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      

    </ul>

  </div>
</nav>


  <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>Categorical Statistics</h1>

  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    May 21, 2020
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    15 min read
  </span>
  

  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/category/r/">R</a></span>
  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style">
      


<p>Note to me: edit this later with the revisions you had for the Kiaser app</p>
<p>Here is a revision of a final project I submitted in Fall of 2019 for an Analysis of Categorical Data Analysis course at UC Davis.</p>
<center>
<h2>
Final Project
</h2>
</center>
<div id="introduction" class="section level3">
<h3>Introduction</h3>
<p>In 1973, a large cotton textile company in North Carolina participated in a study to investigate the prevalence of byssinosis, a form of pneumoconiosis to which workers exposed to cotton dust are subject. Data was collected on 5,419 workers, including:</p>
<ul>
<li>Type of work place [1 (most dusty), 2 (less dusty), 3 (least dusty)]</li>
<li>Employment, years [&lt; 10, 10-19, 20-]</li>
<li>Smoking [Smoker, or not in last 5 years]</li>
<li>Sex [Male, Female]</li>
<li>Race [White, Other]</li>
<li>Byssinosis [Yes, No]</li>
</ul>
<p>In this report, we will evaluate the effect of the level of dust in the work place, lengeth of employment, smoking status, sex, and / or race have on the odds that a person will get byssinosis. In order to analyze this data we will make use of categorical data analysis methods, due to the categorical nature of this data. Before any analysis was made, it would first be important to set the variable of type of work place as a factor with levels of 1, 2, and 3; rather than as a continuous variable. After understanding the nature of what this data looks like we will move to fit a model to the given data, as well as, make inference on which of the predicted variables recorded offer a significant effect on the presence of byssinosis in a given subject. Our goal in using model fitting in this way would be to make further predictions on a persons risk for contracting the disease if more data were to be collected.</p>
<p>We’ll begin our analysis by looking at a summary of the data collected. To accomplish this we can look at a plot of multiple boxplot measuring byssinosis by one predictor split up by its levels:</p>
<pre class="r"><code>library(ggplot2)
library(plyr)
b.data = read.csv(&quot;Byssinosis.csv&quot;)
b.data$Workspace = as.factor(b.data$Workspace)
ggplot(data = b.data, mapping = aes(x = Workspace, y = Byssinosis)) +
  labs(title=&quot;Byssinosis by Dustyness of Workspace&quot;,x=&quot;type of workspace&quot;, y = &quot;# subjects with Byssinosis&quot;) +
  theme_classic() +
  geom_boxplot()</code></pre>
<p><img src="/post/2020-05-21-r-rmarkdown_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>Looking at the above plot on the number of subjects with byssinosis by the level of type of workspace, we see that the distribution of byssinosis does not appear to be the same accross the levels workspace. When looking at these distributions, it may be important to note that the level of 1 correlates with the most dusty workspace and the level of 3 is the least dusty. Just visually from this plot, we could guess that the dustyness level of the subject’s workspace may be a factor that changes the likelihood of byssinosis; however, more inferencial statistics would need to be conducted in order to make a conclusion about statistical significance of this variable.</p>
<pre class="r"><code>ggplot(data = b.data, mapping = aes(x = Employment, y = Byssinosis), main = &quot;Bysinosis status by Employment length&quot;) +
  labs(title=&quot;Byssinosis by Length of Employment&quot;,x=&quot;length of employment (years)&quot;, y = &quot;# subjects with Byssinosis&quot;) +
  theme_classic() +
  geom_boxplot()</code></pre>
<p><img src="/post/2020-05-21-r-rmarkdown_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>Looking at the above plot on the number of subjects with byssinosis by the level of time employed, we see that the distribution of byssinosis does not appear to be the same accross the levels of employment. Just visually from this plot, we could guess that employment may be a factor that changes the likelihood of byssinosis, however more inferencial statistics would need to be conducted in order to make a conclusion about statistical significance of this variable.</p>
<pre class="r"><code>ggplot(data = b.data, mapping = aes(x = Smoking, y = Byssinosis)) +
  labs(title=&quot;Byssinosis by Smoking Status&quot;,x=&quot;smoking status&quot;, y = &quot;# subjects with Byssinosis&quot;) +
  theme_classic() +
  geom_boxplot()</code></pre>
<p><img src="/post/2020-05-21-r-rmarkdown_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>Looking at the above plot on the number of subjects with byssinosis by the level of smoking status, we see that the distribution of byssinosis does not appear to be the same accross the levels of employment. Just visually from this plot, we could guess that employment may be a factor that changes the likelihood of byssinosis, particualrly that it appears there are more sujects that smoke with the lung disease, however more inferencial statistics would need to be conducted in order to make a conclusion about statistical significance of this variable.</p>
<pre class="r"><code>ggplot(data = b.data, mapping = aes(x = Sex, y = Byssinosis)) +
  labs(title=&quot;Byssinosis by Sex&quot;,x=&quot;Sex&quot;, y = &quot;# subjects with Byssinosis&quot;) +
  theme_classic() +
  geom_boxplot()</code></pre>
<p><img src="/post/2020-05-21-r-rmarkdown_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Looking at the above plot on the number of subjects with byssinosis by the level of time employed, we see that the distribution of byssinosis could potentially the same accross the levels of sex. Just visually from this plot, we see that males tend to have more positive outliers but it would be difficut to guess if the difference amounts to it being a factor that changes the likelihood of byssinosis, however more inferencial statistics would need to be conducted in order to make a conclusion about statistical significance of this variable</p>
<pre class="r"><code>ggplot(data = b.data, mapping = aes(x = Race, y = Byssinosis)) +
  labs(title=&quot;Byssinosis by Race&quot;,x=&quot;race&quot;, y = &quot;# subjects with Byssinosis&quot;) +
  theme_classic() +
  geom_boxplot()</code></pre>
<p><img src="/post/2020-05-21-r-rmarkdown_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>Looking at the above plot on the number of subjects with byssinosis by the level race between white or other, we see a similar picture as in the plot by level of sex. Just visually from this plot, we would again guess that sex is most likely not a factor that changes the likelihood of byssinosis, however more inferencial statistics would need to be conducted in order to make a conclusion about statistical significance of this variable</p>
</div>
<div id="explotatory-data-analysis" class="section level3">
<h3>Explotatory Data Analysis</h3>
<p>Moving on in our exploration of this data we move on to attempting to fit a model that will help us predict a subjects byssinosis status given these predictors, and whether or notthe predictor adds a significant effect to the odds of having byssinosis. To do so, we choose to start with a generalized additive linear model for the log odds of having byssinosis. Shown below is the summary of this full model. From this summary we see that all the predictos except sex and race show a significant p-value from the Wald test for significance of a factor in logistic regression.</p>
<pre class="r"><code>fullModel = glm(cbind(Byssinosis,Non.Byssinosis) ~., data = b.data,family = binomial())
nullModel = glm(cbind(Byssinosis,Non.Byssinosis) ~ 1, data = b.data,family = binomial())
summary(fullModel)
## 
## Call:
## glm(formula = cbind(Byssinosis, Non.Byssinosis) ~ ., family = binomial(), 
##     data = b.data)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.5240  -0.8105  -0.1952   0.2071   1.5643  
## 
## Coefficients:
##                 Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)      -2.3463     0.2639  -8.891  &lt; 2e-16 ***
## Employment&gt;=20    0.7531     0.2161   3.484 0.000493 ***
## Employment10-19   0.5641     0.2617   2.156 0.031091 *  
## SmokingYes        0.6413     0.1944   3.299 0.000971 ***
## SexM             -0.1239     0.2288  -0.542 0.587983    
## RaceW            -0.1163     0.2072  -0.562 0.574426    
## Workspace2       -2.5799     0.2921  -8.834  &lt; 2e-16 ***
## Workspace3       -2.7306     0.2153 -12.681  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 322.527  on 64  degrees of freedom
## Residual deviance:  43.271  on 57  degrees of freedom
## AIC: 165.95
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>We will then look at our selection criterion, the Alkaike Information Criterion (AIC) and Bayesian Information Criterion (BIC). For all of the analysis in the report, we will choose to use forward stepwise regression to minimize the AIC and BIC. Looking first at the output below from using forward stepwise for the AIC, the model that minimizes this criterion is one that includes workspace, employment, and smoking as predictors and excludes sex and race.</p>
<pre class="r"><code>## AIC - additive model
bestforwardAIC=step(nullModel,scope = list(lower = nullModel, upper = fullModel),direction = &quot;forward&quot;)
## Start:  AIC=431.2
## cbind(Byssinosis, Non.Byssinosis) ~ 1
## 
##              Df Deviance    AIC
## + Workspace   2    70.42 183.09
## + Sex         1   281.18 391.86
## + Smoking     1   301.11 411.78
## + Employment  2   312.29 424.97
## + Race        1   316.50 427.18
## &lt;none&gt;            322.53 431.20
## 
## Step:  AIC=183.09
## cbind(Byssinosis, Non.Byssinosis) ~ Workspace
## 
##              Df Deviance    AIC
## + Employment  2   55.315 171.99
## + Smoking     1   58.414 173.09
## + Race        1   67.965 182.64
## &lt;none&gt;            70.419 183.09
## + Sex         1   69.761 184.44
## 
## Step:  AIC=171.99
## cbind(Byssinosis, Non.Byssinosis) ~ Workspace + Employment
## 
##           Df Deviance    AIC
## + Smoking  1   43.882 162.56
## &lt;none&gt;         55.315 171.99
## + Race     1   55.005 173.68
## + Sex      1   55.293 173.97
## 
## Step:  AIC=162.56
## cbind(Byssinosis, Non.Byssinosis) ~ Workspace + Employment + 
##     Smoking
## 
##        Df Deviance    AIC
## &lt;none&gt;      43.882 162.56
## + Race  1   43.563 164.24
## + Sex   1   43.586 164.26</code></pre>
<p>Similarly, we can look at the output for forward stepwise regression for minimizing the BIC, by changing our k to equal log(n=5,419). Noting that the output below will still display the term AIC, but it is actually the BIC that is being calculated. When using this selection criterion, it tells us to use a model that includes only workspace and smoking and excludes the others. This is not two surprising considering the BIC penalizes complexity more than the AIC does.</p>
<p>With the context of this data, a false negative would be more harmful, in that if we conclude that something like the length of employment does not predict the odds of contracting byssinosis when in reality it does would be more harmful than concluding the opposite. In a situation similar to the example just stated the AIC usually preforms better, to I am leaning towards choosing that model using AIC, rather than BIC for this analysis.</p>
<pre class="r"><code>## BIC - additive model
bestforwardBIC=step(nullModel,scope = list(lower = nullModel, upper = fullModel),direction = &quot;forward&quot;, k = log(5419))
## Start:  AIC=483.98
## cbind(Byssinosis, Non.Byssinosis) ~ 1
## 
##              Df Deviance    AIC
## + Workspace   2    70.42 249.07
## + Sex         1   281.18 451.24
## + Smoking     1   301.11 471.16
## &lt;none&gt;            322.53 483.98
## + Race        1   316.50 486.56
## + Employment  2   312.29 490.94
## 
## Step:  AIC=249.07
## cbind(Byssinosis, Non.Byssinosis) ~ Workspace
## 
##              Df Deviance    AIC
## + Smoking     1   58.414 245.66
## &lt;none&gt;            70.419 249.07
## + Employment  2   55.315 251.16
## + Race        1   67.965 255.22
## + Sex         1   69.761 257.01
## 
## Step:  AIC=245.66
## cbind(Byssinosis, Non.Byssinosis) ~ Workspace + Smoking
## 
##              Df Deviance    AIC
## &lt;none&gt;            58.414 245.66
## + Employment  2   43.882 248.33
## + Race        1   56.171 252.02
## + Sex         1   58.388 254.24</code></pre>
<p>Continuing with our analysis, we will next look at turning out additive model into an interactive one by adding any single term interactions to include in our model. Below is the output for the Wald test for significance of a sigle term addition factor in logistic regression. From this input, we see that there appears to be one significant interaction sex and workspace, and it appears that this interaction also lowers our AIC.</p>
<pre class="r"><code>add1(fullModel,scope=~Employment*Smoking*Race*Sex*Workspace,test=&quot;Chisq&quot;) 
## Single term additions
## 
## Model:
## cbind(Byssinosis, Non.Byssinosis) ~ Employment + Smoking + Sex + 
##     Race + Workspace
##                      Df Deviance    AIC    LRT Pr(&gt;Chi)  
## &lt;none&gt;                    43.271 165.95                  
## Employment:Smoking    2   41.442 168.12 1.8286  0.40080  
## Employment:Race       2   41.147 167.82 2.1245  0.34569  
## Smoking:Race          1   41.906 166.58 1.3646  0.24274  
## Employment:Sex        2   41.862 168.54 1.4090  0.49435  
## Smoking:Sex           1   42.564 167.24 0.7074  0.40032  
## Race:Sex              1   43.237 167.91 0.0344  0.85286  
## Employment:Workspace  4   38.766 169.44 4.5052  0.34193  
## Smoking:Workspace     2   38.679 165.35 4.5924  0.10064  
## Race:Workspace        2   42.560 169.24 0.7115  0.70066  
## Sex:Workspace         2   35.721 162.40 7.5500  0.02294 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Next, we’ll continue the analysis by again using forward stepwise regression in order to determine if we should include any interactions in our final model. We’ll set the scope of this stepwise regression be from an empty model to a model that includes all of our predictors and all of combinations of single term interactions between them. When looking at minimizing the AIC when we include interaction terms, when looking at the output below, we are left with a model that includes workplace, lenght of employment, smoking status, and an interaction between smoking status and workspace. The reason this does not include the interaction between sex and workspace that we discovered using the Wald test is most likely due to the fact that in order to include this interaction in our model, we would also have to include the predictor sex in the model. As we can recall, sex was not included when we minimized AIC when using only an additive model, so it is likely that including this interaction would decrease our AIC overall in order to include the interaction.</p>
<pre class="r"><code>all.int.model = glm(cbind(Byssinosis,Non.Byssinosis) ~.^2, data = b.data,family = binomial())
## AIC - interactive model
bestforwardAICint=step(nullModel,scope = list(lower = nullModel, upper = all.int.model),direction = &quot;forward&quot;) 
## Start:  AIC=431.2
## cbind(Byssinosis, Non.Byssinosis) ~ 1
## 
##              Df Deviance    AIC
## + Workspace   2    70.42 183.09
## + Sex         1   281.18 391.86
## + Smoking     1   301.11 411.78
## + Employment  2   312.29 424.97
## + Race        1   316.50 427.18
## &lt;none&gt;            322.53 431.20
## 
## Step:  AIC=183.09
## cbind(Byssinosis, Non.Byssinosis) ~ Workspace
## 
##              Df Deviance    AIC
## + Employment  2   55.315 171.99
## + Smoking     1   58.414 173.09
## + Race        1   67.965 182.64
## &lt;none&gt;            70.419 183.09
## + Sex         1   69.761 184.44
## 
## Step:  AIC=171.99
## cbind(Byssinosis, Non.Byssinosis) ~ Workspace + Employment
## 
##                        Df Deviance    AIC
## + Smoking               1   43.882 162.56
## &lt;none&gt;                      55.315 171.99
## + Race                  1   55.005 173.68
## + Sex                   1   55.293 173.97
## + Employment:Workspace  4   50.504 175.18
## 
## Step:  AIC=162.56
## cbind(Byssinosis, Non.Byssinosis) ~ Workspace + Employment + 
##     Smoking
## 
##                        Df Deviance    AIC
## + Smoking:Workspace     2   39.031 161.71
## &lt;none&gt;                      43.882 162.56
## + Race                  1   43.563 164.24
## + Sex                   1   43.586 164.26
## + Employment:Smoking    2   42.077 164.75
## + Employment:Workspace  4   39.282 165.96
## 
## Step:  AIC=161.71
## cbind(Byssinosis, Non.Byssinosis) ~ Workspace + Employment + 
##     Smoking + Workspace:Smoking
## 
##                        Df Deviance    AIC
## &lt;none&gt;                      39.031 161.71
## + Race                  1   38.755 163.43
## + Employment:Smoking    2   36.772 163.45
## + Sex                   1   38.953 163.63
## + Employment:Workspace  4   34.291 164.97</code></pre>
<p>Similarly, we’ll continue again by using stepwise regression to minimize the BIC. Unsurprisingly, using this model we are left with the same model as before we added in the interactive terms, which is one that includes only work space and smoking status. This is mostlikely due to the fact the BIC penalizes complexity in the model and will most likely contain less predictors than that of the AIC.</p>
<pre class="r"><code>## BIC - interactive model
bestforwardBICint=step(nullModel,scope = list(lower = nullModel, upper = all.int.model),direction = &quot;forward&quot;, k = log(5419))
## Start:  AIC=483.98
## cbind(Byssinosis, Non.Byssinosis) ~ 1
## 
##              Df Deviance    AIC
## + Workspace   2    70.42 249.07
## + Sex         1   281.18 451.24
## + Smoking     1   301.11 471.16
## &lt;none&gt;            322.53 483.98
## + Race        1   316.50 486.56
## + Employment  2   312.29 490.94
## 
## Step:  AIC=249.07
## cbind(Byssinosis, Non.Byssinosis) ~ Workspace
## 
##              Df Deviance    AIC
## + Smoking     1   58.414 245.66
## &lt;none&gt;            70.419 249.07
## + Employment  2   55.315 251.16
## + Race        1   67.965 255.22
## + Sex         1   69.761 257.01
## 
## Step:  AIC=245.66
## cbind(Byssinosis, Non.Byssinosis) ~ Workspace + Smoking
## 
##                     Df Deviance    AIC
## &lt;none&gt;                   58.414 245.66
## + Employment         2   43.882 248.33
## + Race               1   56.171 252.02
## + Sex                1   58.388 254.24
## + Smoking:Workspace  2   53.083 257.53</code></pre>
<p>After using these diagnostics, we will decide on a final model that was suggested by the AIC when including interactive terms. This was a model that included the dustyness of workspace, length of employment, smoking status, and an interaction between dustyness of workspace and smoking status:</p>
<pre class="r"><code>final.model = glm(cbind(Byssinosis,Non.Byssinosis) ~Workspace + Employment + Smoking + Workspace*Smoking, data = b.data,family = binomial())
summary(final.model)$coefficients
##                         Estimate Std. Error    z value     Pr(&gt;|z|)
## (Intercept)           -2.7146022  0.2645170 -10.262485 1.039955e-24
## Workspace2            -1.7769484  0.4176649  -4.254483 2.095324e-05
## Workspace3            -2.3461198  0.3727790  -6.293594 3.101979e-10
## Employment&gt;=20         0.6638259  0.1819389   3.648619 2.636534e-04
## Employment10-19        0.4989688  0.2499100   1.996594 4.586933e-02
## SmokingYes             0.9572850  0.2750856   3.479953 5.015019e-04
## Workspace2:SmokingYes -1.1806748  0.5489627  -2.150738 3.149691e-02
## Workspace3:SmokingYes -0.4864177  0.4338355  -1.121203 2.622014e-01</code></pre>
<p>The using the above coefficients, the formula for the final model that given by:</p>
<p><span class="math display">\[\log(\frac{\pi}{1-\pi}) = -2.7146 + (-1.7769)X_{Workspace, less dusty} + (-2.3461)X_{Workspace, least dusty} + 0.6638X_{Employment, \ge20} \]</span></p>
<p><span class="math display">\[+ 0.4990X_{Employment, 10-19} + 0.9573X_{Smoking, yes} + (-1.1807)X_{Workspace, less dusty:Smoking, yes} + (-0.4864)X_{Workspace, least dusty:Smoking, yes}\]</span></p>
<pre class="r"><code>b0=summary(final.model)$coefficients[1,1]
b1=summary(final.model)$coefficients[2,1]
b2=summary(final.model)$coefficients[3,1]
b3=summary(final.model)$coefficients[4,1]
b4=summary(final.model)$coefficients[5,1]
b5=summary(final.model)$coefficients[6,1]
b6=summary(final.model)$coefficients[7,1]
b7=summary(final.model)$coefficients[8,1]
e.b0 = exp(b0)
e.b1 = exp(b1)
e.b2 = exp(b2)
e.b3 = exp(b3)
e.b4 = exp(b4)
e.b5 = exp(b5)
e.b6 = exp(b6)
e.b7 = exp(b7)</code></pre>
<ul>
<li>exp(<span class="math inline">\(\beta_0\)</span>) = 0.0662313</li>
<li>exp(<span class="math inline">\(\beta_1\)</span>) = 0.1691536</li>
<li>exp(<span class="math inline">\(\beta_2\)</span>) = 0.0957399</li>
<li>exp(<span class="math inline">\(\beta_3\)</span>) = 1.9422089</li>
<li>exp(<span class="math inline">\(\beta_4\)</span>) = 1.6470221</li>
<li>exp(<span class="math inline">\(\beta_5\)</span>) = 2.6046154</li>
<li>exp(<span class="math inline">\(\beta_6\)</span>) = 0.3070714</li>
<li>exp(<span class="math inline">\(\beta_7\)</span>) = 0.6148249</li>
</ul>
<p>Furthermore, we can interpret the coefficients of the model in terms of their effect on the odds on the status of byssinosis using the values above. We can see that the indicator for employment greater than or equal to 10 and smoking status is no are the only three predictors that result in a positive effect on having byssinosis. Concurrently, the other variables result in the decrease of having byssinosis when all others are zero.</p>
</div>
<div id="summary" class="section level3">
<h3>Summary</h3>
<p>By making use of categorical data analysis, we can conclude that the dustyness of workspace, length of employment, and smoking status are all significant factors to consider when trying to predict if a worker in these conditions would contract byssinosis. Through the analysis of this data we have determined that there is also a significant interaction between dustyness of workspace and smoking status that would be important to take into account in this model. By taking into account both the AIC and BIC we were able to get a full picture on how to best to fit our model with out over or under simplifying our model with the hope of making use of further predictions.</p>
</div>

    </div>

    





<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/statistics/">statistics</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/post/2020-05-21-r-rmarkdown/&amp;text=Categorical%20Statistics" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/post/2020-05-21-r-rmarkdown/&amp;t=Categorical%20Statistics" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Categorical%20Statistics&amp;body=/post/2020-05-21-r-rmarkdown/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/post/2020-05-21-r-rmarkdown/&amp;title=Categorical%20Statistics" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=Categorical%20Statistics%20/post/2020-05-21-r-rmarkdown/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=/post/2020-05-21-r-rmarkdown/&amp;title=Categorical%20Statistics" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>












  
  





  
    
    
    
      
    
    
    
    <div class="media author-card content-widget-hr">
      
        
        <img class="avatar mr-3 avatar-circle" src="/author/tiffany-dunn/avatar_hu9b56b1cdd2fcb4f7362de77c9c0119b5_1765182_270x270_fill_q90_lanczos_center.jpg" alt="Tiffany Dunn">
      

      <div class="media-body">
        <h5 class="card-title"><a href="/">Tiffany Dunn</a></h5>
        <h6 class="card-subtitle">Graduating Applied Statistics Student</h6>
        <p class="card-text">My research interests include distributed robotics, mobile computing and programmable matter.</p>
        <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/tiffany-m-dunn" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.co.uk/citations?user=I2n-GFkAAAAJ&amp;hl=en&amp;oi=sra" target="_blank" rel="noopener">
        <i class="ai ai-google-scholar"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/tiffdunn" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
</ul>

      </div>
    </div>
  












  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/post/categorical_stats/">Categorical Statistics</a></li>
      
    </ul>
  </div>
  



  </div>
</article>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    <script>const isSiteThemeDark = false;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.37431be2d92d7fb0160054761ab79602.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  
  <p class="powered-by">
    
      <a href="/privacy/">Privacy Policy</a>
    
    
       &middot; 
      <a href="/terms/">Terms</a>
    
  </p>
  

  <p class="powered-by">
    

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
